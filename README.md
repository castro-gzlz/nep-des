# **nep-des**
This code generates **period–radius diagrams** with the **population-based boundaries** of the **Neptunian desert**, **ridge**, and **savanna**, as derived in [Castro-González et al. (2024)](https://ui.adsabs.harvard.edu/abs/2024A%26A...689A.250C/abstract). It also generates two-column plots with the **density trend** for super-Neptune and sub-Jovian planets identified in [Castro-González et al. (2024b)](https://ui.adsabs.harvard.edu/abs/2024A%26A...691A.233C/abstract).

![Spice Dune Exo-Neptunian 3-01](https://github.com/user-attachments/assets/0ab75a3f-bbb7-429c-a9fe-8d5b3f2b4ed1)
<sup> © Elsa Bersier / ERC project SPICE DUNE </sup>

## Installation and Usage

No installation is required. Simply **clone** or **download** this repository and run [`nep_des.ipynb`](https://github.com/castro-gzlz/nep-des/blob/main/nep_des.ipynb). You only need to adapt the [User configuration](nep_des.ipynb#user-configuration) section, run the (collapsed) cells in the **main code block**, and then execute any of the plotting cells. In the following, we show example use cases covering the **three types of figures** generated by the code. The corresponding configuration cells for each example can be found in [this file](aux/config_examples.ipynb).

## 1. The exo-Neptunian landscape (desert, ridge, and savanna)

In the left panel ([example #1](aux/config_examples.ipynb)), we contextualize several unusually short-period planets located within the core of the Neptunian desert. In the right panel ([example #2](aux/config_examples.ipynb)), we place a sub-Saturn within the broader exo-Neptunian landscape (desert, ridge, and savanna) and highlight it with a text box.

<img width="5526" height="2530" alt="examples1 2" src="https://github.com/user-attachments/assets/6f1d3faf-e778-4244-a55c-be510542dd56" />

## 2. The super-Neptune / sub-Jovian density trend

In this two-panel plot ([example #3](aux/config_examples.ipynb)), we contextualize several planets along the **density trend for super-Neptune and sub-Jovian planets** identified in [Castro-González et al. (2024b)](https://ui.adsabs.harvard.edu/abs/2024A%26A...691A.233C/abstract). Planets in the savanna exhibit low densities, typically below 1 g/cm³, whereas those in the ridge & desert can reach densities of 2 g/cm³ or higher. Remarkably, the density transition aligns closely with the observed planet-occurrence break between the ridge and savanna (at roughly ~6 days), suggesting that **desert and ridge planets may share common formation and/or evolutionary pathways distinct from that of Neptunes in the savanna** (see the papers for further discussion).

<img width="5584" height="2530" alt="nep_dens_example3" src="https://github.com/user-attachments/assets/1562b4a1-d8dd-4ec3-a242-2ae10aaea8ab" />

This plotting option also uses an MCMC approach to assess the significance of the trend. At present, without including the (duplicated) user-plotted planets (`include_user_planets_in_density_stats = False`):


<img width="3020" height="623" alt="Captura de pantalla 2025-12-02 a las 14 24 21" src="https://github.com/user-attachments/assets/7fe8c38a-eed2-461c-8080-54cdb66ffc38" />



We obtain a KS p-value of 0.0065 for the (DESERT + RIDGE) vs. SAVANNA comparison, which is slightly lower than the originally published value (KS p-value = 0.0092; [Castro-González et al. 2024b](https://ui.adsabs.harvard.edu/abs/2024A%26A...691A.233C/abstract)). This significant result shows that **the density distributions of the desert+ridge and savanna are different**. Remarkably, **there is no evidence of a density difference between the desert and ridge planets** (p-value = 0.27), which is somewhat expected given the very small desert sample (N_desert = 6). Still, the Cliff's delta remains high (0.38), which suggests a potentially meaningful effect that current sample sizes are not sufficient to confirm. In this line, we note that relatively low-density super-Neptunes exist in the ridge but not in the desert—an intriguing feature consistent with the proposed **density brink** ([Bourrier et al. 2025](https://ui.adsabs.harvard.edu/abs/2025A%26A...701A.190B/abstract)).

## 3. The Neptunian desert

Finally, we can generate the **exact KDE-derived desert boundaries** from [Castro-González et al. (2024)](https://ui.adsabs.harvard.edu/abs/2024A%26A...689A.250C/abstract). These boundaries are broadly consistent with the approximate ones shown in the previous examples. However, they are especially valuable for contextualizing sub-Neptunes located near the **opening of the radius valley**, a region that is less well captured by straight-line approximations. For this plot format, the background is always drawn from the **Kepler DR25 catalogue** ([Thompson et al. 2018](https://ui.adsabs.harvard.edu/abs/2018ApJS..235...38T/abstract)), to which the **Inverse Detection Efficiency Method (IDEM)** was applied to derive the corresponding bias-corrected boundaries.


<img width="5526" height="2530" alt="examples4 5" src="https://github.com/user-attachments/assets/41154945-057d-4b8b-88d0-6a846622c36e" />


In the left panel ([example #4](aux/config_examples.ipynb)), we illustrate how to contextualize a single planet. In the right panel ([example #5](aux/config_examples.ipynb)), we show how to contextualize multiple planets with legend labels and how to display features such as the ridge and the savanna. We also demonstrate how to draw the classical desert boundaries of [Mazeh et al. (2016)](https://ui.adsabs.harvard.edu/abs/2016A%26A...589A..75M/abstract) using the option `show_mazeh_boundaries = True`, which can be activated for any of the *nep-des* plot types.


## Credits

If you use our population-based mapping of the exo-Neptunian landscape, please give credit to [this work](https://ui.adsabs.harvard.edu/abs/2024A%26A...689A.250C/abstract):

```
@ARTICLE{2024A&A...689A.250C,
       author = {{Castro-Gonz{\'a}lez}, A. and {Bourrier}, V. and {Lillo-Box}, J. and {Delisle}, J. -B. and {Armstrong}, D.~J. and {Barrado}, D. and {Correia}, A.~C.~M.},
        title = "{Mapping the exo-Neptunian landscape: A ridge between the desert and savanna}",
      journal = {\aap},
     keywords = {planets and satellites: atmospheres, planets and satellites: dynamical evolution and stability, planets and satellites: formation, planets and satellites: gaseous planets, planets and satellites: physical evolution, Astrophysics - Earth and Planetary Astrophysics},
         year = 2024,
        month = sep,
       volume = {689},
          eid = {A250},
        pages = {A250},
          doi = {10.1051/0004-6361/202450957},
archivePrefix = {arXiv},
       eprint = {2409.10517},
 primaryClass = {astro-ph.EP},
       adsurl = {https://ui.adsabs.harvard.edu/abs/2024A&A...689A.250C},
      adsnote = {Provided by the SAO/NASA Astrophysics Data System}
}
```

If you make use of *nep-des* to implement the exo-Neptunian boundaries in your research, please also include the following sentence within the acknowledgements section:

> This research made use of \texttt{nep-des} (available in \url{https://github.com/castro-gzlz/nep-des})

Please also give credit to the catalogue(s) used: Nasa Exoplanet Archive ([Akeson et al. 2013](https://ui.adsabs.harvard.edu/abs/2013PASP..125..989A/abstract); [Christiansen et al. 2025](https://ui.adsabs.harvard.edu/abs/2025PSJ.....6..186C/abstract)), Exoplanet.eu ([Schneider et al. 2011](https://ui.adsabs.harvard.edu/abs/2011A%26A...532A..79S/abstract)), and/or Kepler DR25 ([Thompson et al. 2018](https://ui.adsabs.harvard.edu/abs/2018ApJS..235...38T/abstract)).


